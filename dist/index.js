'use strict';Object.defineProperty(exports,'__esModule',{value:true});var jspdf=require('jspdf');var L=(n=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(n,{get:(t,e)=>(typeof require!="undefined"?require:t)[e]}):n)(function(n){if(typeof require!="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported')});var T=(n,t=false)=>{var i;let e,o;for(o=n.nodeType===3?document.createTextNode(n.nodeValue||""):n.cloneNode(false),e=n.firstChild;e;)(t===true||e.nodeType!==1||e.nodeName!=="SCRIPT")&&o.appendChild(T(e,t)),e=e.nextSibling;if(n.nodeType===1){if(n.nodeName==="CANVAS"){let r=n,a=o;a.width=r.width,a.height=r.height,(i=a.getContext("2d"))==null||i.drawImage(r,0,0);}else (n.nodeName==="TEXTAREA"||n.nodeName==="SELECT")&&(o.value=n.value);o.addEventListener("load",()=>{o.scrollTop=n.scrollTop,o.scrollLeft=n.scrollLeft;},true);}return o},f=(n,t={})=>{var a;let{className:e,innerHTML:o,style:i}=t,r=document.createElement(n);if(e&&(r.className=e),o){r.innerHTML=o;let l=r.getElementsByTagName("script"),s=l.length;for(;s-- >0;)(a=l[s].parentNode)==null||a.removeChild(l[s]);}return i&&M(r,i),r},M=(n,t)=>{Object.keys(t).forEach(e=>{n.style[e]=t[e];});},b=(n,t)=>{t.forEach(e=>{n.querySelectorAll(`.${e}`).forEach(o=>o.remove());});},C=(n,t)=>{t.forEach(e=>{var i;let o=n.getElementsByTagName(e);for(let r=o.length-1;r>=0;r--)o[r]&&((i=o[r].parentNode)==null||i.removeChild(o[r]));});};var P=(n,t)=>{var i;let e={before:false},o=n.getBoundingClientRect();if(!e.before){let r=Math.floor(o.top/t),a=Math.floor(o.bottom/t),l=Math.abs(o.bottom-o.top)/t;if(a!==r&&l<=1&&(e.before=true),e.before){let s=f("div",{style:{display:"block",height:`${t-o.top%t}px`}});(i=n.parentNode)==null||i.insertBefore(s,n);}}};var p=class p{constructor(t,e={}){this.originalElement=t,this.options={excludeClassNames:e.excludeClassNames||[],excludeTagNames:e.excludeTagNames||["button","input","select"],overrideWidth:e.overrideWidth||0};let{overlay:o,container:i}=this.createOverlayAndContainer();this.overlay=o,this.container=i;let r=p.A4_HEIGHT/p.A4_WIDTH,a=this.options.overrideWidth||this.container.getBoundingClientRect().width;this.pageHeightPx=Math.floor(a*r),this.setupContainer();}getContainer(){return this.container}getOverlay(){return this.overlay}getPageHeightPx(){return this.pageHeightPx}remove(){document.body.removeChild(this.overlay);}createOverlayAndContainer(){let t={position:"fixed",zIndex:"1000",opacity:"0",left:"0",right:"0",bottom:"0",top:"0",backgroundColor:"rgba(0,0,0,0.8)"};this.options.overrideWidth&&(t.width=`${this.options.overrideWidth}px`);let e={position:"absolute",left:"0",right:"0",top:"0",height:"auto",margin:"auto",overflow:"auto",backgroundColor:"white"},o=f("div",{style:t}),i=f("div",{style:e});return i.appendChild(T(this.originalElement)),o.appendChild(i),document.body.appendChild(o),{overlay:o,container:i}}setupContainer(){this.removeExcludedElements(),this.handlePageBreaks();}removeExcludedElements(){let{excludeClassNames:t,excludeTagNames:e}=this.options;b(this.container,t),C(this.container,e);}handlePageBreaks(){let t=this.container.querySelectorAll("*");Array.from(t).forEach(e=>{P(e,this.pageHeightPx);});}};p.A4_HEIGHT=841.89,p.A4_WIDTH=595.28;var g=p;var w=n=>{let t=document.createElement("canvas");t.width=n.width,t.height=n.height;let e=t.getContext("2d");return e&&(e.fillStyle="#FFFFFF",e.fillRect(0,0,t.width,t.height)),n.toDataURL()===t.toDataURL()},N=(n,t,e,o)=>{let i=e.getContext("2d");if(!i)throw new Error("Could not get canvas context");let r=e.width,a=e.height;return i.fillStyle="white",i.fillRect(0,0,r,a),i.drawImage(n,0,t*o,r,a,0,0,r,a),!w(e)};var O=L("dom-to-image"),u=class u{constructor(t,e={},o){this.container=t,this.callback=o,this.options={filename:e.filename||"generated.pdf",excludeClassNames:e.excludeClassNames||[],excludeTagNames:e.excludeTagNames||["button","input","select"],overrideWidth:e.overrideWidth||0,proxyUrl:e.proxyUrl||"",compression:e.compression||"NONE",scale:e.scale||0,output:e.output||"pdf"};}async generate(){try{let t=await this.generateCanvas();return this.generatePdfFromCanvas(t)}catch(t){return this.callback&&this.callback(null),console.error(t),null}}async generateCanvas(){let t=this.createDomToImageOptions();return O.toCanvas(this.container,t)}createDomToImageOptions(){let t={filter:this.createFilterFunction(),proxy:this.options.proxyUrl};if(this.options.scale){let e=this.container.offsetWidth,o=this.container.offsetHeight,i={transform:`scale(${this.options.scale})`,transformOrigin:"top left",width:`${e}px`,height:`${o}px`},r={width:e*this.options.scale,height:o*this.options.scale,quality:1,style:i};Object.assign(t,r);}return t}createFilterFunction(){let{excludeClassNames:t,excludeTagNames:e}=this.options;return ({classList:o,tagName:i})=>{if(o){for(let a of t)if(Array.prototype.indexOf.call(o,a)>=0)return  false}let r=i==null?void 0:i.toLowerCase();return r?e.indexOf(r)<0:true}}generatePdfFromCanvas(t){let{A4_WIDTH:e,A4_HEIGHT:o}=u,{compression:i,filename:r,output:a}=this.options,l=this.options.overrideWidth||this.container.getBoundingClientRect().width,s=Math.floor(l*(o/e)),c=new jspdf.jsPDF({orientation:"p",unit:"pt",format:"a4"}),E=t.height,x=Math.ceil(E/s),m=document.createElement("canvas");m.width=t.width,m.height=s;for(let h=0;h<x;h++){let y=o;if(h===x-1&&E%s!==0&&(m.height=E%s,y=m.height*e/m.width),!N(t,h,m,s))continue;h>0&&c.addPage();let H=m.toDataURL("image/PNG");c.addImage(H,"PNG",0,0,e,y,void 0,i);}return this.callback&&this.callback(c),a==="blob"?c.output("blob"):a==="base64"?c.output("datauristring"):a==="pdf"?c.save(r):c}};u.A4_HEIGHT=841.89,u.A4_WIDTH=595.28;var v=u;var k=async(n,t={},e)=>{try{let o=new g(n,t),r=await new v(o.getContainer(),t,e).generate();return o.remove(),r}catch(o){return console.error("Error generating PDF:",o),e&&e(null),null}},Z=k;exports.DomContainer=g;exports.PdfGenerator=v;exports.applyStyles=M;exports.cloneNode=T;exports.createElement=f;exports.default=Z;exports.domToPdf=k;exports.drawPdfPage=N;exports.isCanvasBlank=w;exports.removeElementsByClassName=b;exports.removeElementsByTagName=C;//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map